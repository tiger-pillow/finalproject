knitr::opts_chunk$set(echo = TRUE)
library(ape)
library(ggtree)
library(knitr)
library(phytools)
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree(tree2) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = x), size = 10 )
knitr::opts_chunk$set(echo = TRUE)
library(ape)
library(ggtree)
library(knitr)
library(phytools)
tree_readin = read.nexus('1028_output.nex')
tree2 = random.tree<-sample(tree_readin,size=1)[[1]]
#print(tree2)
#plot(tree2)
consensusTree = consensus(tree_readin, p = 0.5, check.labels = FALSE)
plot(consensusTree)
# Character state matrix
charstate = read.csv('1028_MVP2.csv', row.names = 1)
charstate = as.matrix(charstate)[,1]
#plotTree(tree2, type = 'fan', ftype = 'i', fsize = 1)
result = ace(charstate, tree2, type = 'continuous', method = 'ML')
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree(tree2) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = x), size = 10 )
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree(tree2) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(colour = x), size = 10 )
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree(tree2) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(colour = x), size = 10 )
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree(tree2) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = (x)), size = 10 )
tree_readin = read.nexus('1028_output.nex')
tree2 = random.tree<-sample(tree_readin,size=1)[[1]]
#print(tree2)
#plot(tree2)
consensusTree = consensus(tree_readin, p = 0.5, check.labels = FALSE)
plot(consensusTree)
plot(tree2)
tree_readin = read.nexus('1028_output.nex')
tree2 = random.tree<-sample(tree_readin,size=1)[[1]]
#print(tree2)
#plot(tree2)
consensusTree = consensus(tree_readin, p = 0.5, check.labels = FALSE)
plot(consensusTree)
plot(tree2)
tree_readin = read.nexus('1028_output.nex')
tree2 = random.tree<-sample(tree_readin,size=1)[[1]]
#print(tree2)
#plot(tree2)
consensusTree = consensus(tree_readin, p = 0.5, check.labels = FALSE)
plot(consensusTree)
print(charstate)
tree_readin = read.nexus('1028_output.nex')
tree2 = random.tree<-sample(tree_readin,size=1)[[1]]
#print(tree2)
#plot(tree2)
# consensusTree = consensus(tree_readin, p = 0.5, check.labels = FALSE)
# plot(consensusTree)
kable(charstate)
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggplot(tree2) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = (x)), size = 10 )
View(tree2)
contresult = contMap(tree2, charstate, plot = FALSE)
plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree(tree2) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = (x)), size = 10 )
contresult = contMap(tree2, charstate, plot = FALSE)
plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree( tree2 ) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = x), size = 10 )
contresult = contMap(tree2, charstate, plot = FALSE)
plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree( tree2 ) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = charstate.x), size = 10 )
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree( charstate ) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = charstate.x), size = 10 )
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
litter_plot = ggtree( tree2 ) %<+% D +
geom_tiplab( fontface = 'italic', offset = 20) +
xlim(0, 300) +
geom_tippoint(aes(color = x), size = 10 )
#contresult = contMap(tree2, charstate, plot = FALSE)
#plot(contresult, lwd = 5, legend = 0.7 * max(nodeHeights(tree2)),outline = 0) # fsize = c(0.5, 0.5)
D = data.frame(
species = charstate
)
mass_plot = ggtree( tree2 ) %<+% charstate +
geom_tiplab( fontface = "italic", offset=20 ) +
xlim(0, 300) +
geom_tippoint( aes(color= x), size=3, alpha=1 )
# Character state matrix
charstate = read.csv('1028_MVP2.csv', row.names = 1)
charstate = as.matrix(charstate)[,1]
#plotTree(tree2, type = 'fan', ftype = 'i', fsize = 1)
result = ace(charstate, tree2, type = 'continuous', method = 'ML')
class(charstate)
View(tree2)
View(tree2)
View(tree2)
tree2[["tip.label"]]
